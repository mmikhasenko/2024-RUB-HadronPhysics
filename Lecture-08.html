<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>lecture-08</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Lecture-08_files/libs/clipboard/clipboard.min.js"></script>
<script src="Lecture-08_files/libs/quarto-html/quarto.js"></script>
<script src="Lecture-08_files/libs/quarto-html/popper.min.js"></script>
<script src="Lecture-08_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Lecture-08_files/libs/quarto-html/anchor.min.js"></script>
<link href="Lecture-08_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Lecture-08_files/libs/quarto-html/quarto-syntax-highlighting-d4d76bf8491c20bad77d141916dc28e1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Lecture-08_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Lecture-08_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Lecture-08_files/libs/bootstrap/bootstrap-feb7be27843f6a580260d43995a4e15a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<!--
Cosine simularity: 0.9477788073897907
-->
<section id="introduction-to-analytic-and-holomorphic-functions" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-analytic-and-holomorphic-functions">Introduction to Analytic and Holomorphic Functions</h2>
<p>Today’s lecture will discuss unitarity and complex functions, building on what was briefly mentioned in the previous lecture. This topic is important and connects to concepts you already know from mathematics.</p>
<p>I will introduce two mathematical definitions: <strong>analytic functions</strong> and <strong>holomorphic functions</strong>, which are often used interchangeably.</p>
<p>A function is called <strong>analytic</strong> at a point <span class="math inline">\(x_0\)</span> if it can be represented by a Taylor series that converges to the function in a neighborhood of <span class="math inline">\(x_0\)</span>. Mathematically, this means:</p>
<p><span class="math display">\[
f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(x_0)}{n!} (x - x_0)^n
\]</span></p>
<p>Here, <span class="math inline">\(f^{(n)}(x_0)\)</span> are the coefficients (derivatives of <span class="math inline">\(f\)</span> evaluated at <span class="math inline">\(x_0\)</span>). If such a series exists, the function is analytic at <span class="math inline">\(x_0\)</span>.</p>
<p>Similarly, a function is called <strong>holomorphic</strong> if its complex derivative exists at every point in its domain, meaning the derivative is well-defined regardless of the direction of approach in the complex plane.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The terms <em>analytic</em> and <em>holomorphic</em> are equivalent for complex functions. Don’t be intimidated by the word “holomorphic”—it simply means the function is analytic.</p>
</div>
</div>
<!--
Cosine simularity: 0.945084418823526
-->
</section>
<section id="properties-and-examples-of-analytic-functions" class="level2">
<h2 class="anchored" data-anchor-id="properties-and-examples-of-analytic-functions">Properties and Examples of Analytic Functions</h2>
<p>Don’t be afraid of the word holomorphic—this is just mathematicians inventing cool words. As an example, let me give you functions that are fully analytic. All polynomials are analytic. A rational function (polynomial divided by polynomial) is analytic except at a finite number of points, which are the zeros of the denominator.</p>
<p>When we define a function as analytic at a point, and when we talk about a domain, it means every point in this domain is a point of analyticity. For example, <span class="math inline">\(\sqrt{x}\)</span> is analytic everywhere except at zero. Zero is called a <strong>branch point</strong>, where the derivative does not exist and no Taylor series converges to the function. Both conditions fail, making it non-analytic at that point.</p>
<p>Real analytic functions are another interesting class—they are real-valued and analytic, with certain scalability properties. For example, <span class="math inline">\(\sqrt{x}\)</span> is real analytic. There is a key property called the <strong>Schwarz reflection principle</strong>: if you evaluate the function in the complex plane, it satisfies</p>
<p><span class="math display">\[
f(\overline{z}) = \overline{f(z)}
\]</span></p>
<p>where <span class="math inline">\(\overline{z}\)</span> is the complex conjugate. Using our example, we can test this at <span class="math inline">\(1 + i\)</span>.</p>
<!--
Cosine simularity: 0.9155999997945228
-->
</section>
<section id="introduction-to-analytic-functions-and-complex-plane-visualization" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-analytic-functions-and-complex-plane-visualization">Introduction to Analytic Functions and Complex Plane Visualization</h2>
<p>For analytic functions of a single argument, it is convenient to visualize the domain as a complex plane, where the x-axis represents the real part of the argument and the y-axis represents the imaginary part. At every point in this plane, we can compute the function. While this diagram does not fully describe the function, it helps illustrate its behavior.</p>
<p>The <strong>stress deflection principle</strong> suggests a relationship between the upper and lower half-planes: values in the lower plane can be computed using values from the upper plane. For example, consider the function evaluated at <span class="math inline">\(1 + i\)</span>.</p>
<p><span class="math display">\[
1 + i = \sqrt{2} \cdot e^{i \pi/4}
\]</span></p>
<p>Here, <span class="math inline">\(\sqrt{2}\)</span> is the magnitude (length) and <span class="math inline">\(\pi/4\)</span> (45 degrees) is the angle. Evaluating the function further, we obtain:</p>
<p><span class="math display">\[
\sqrt{1 + i} = \sqrt[4]{2} \cdot e^{i \pi/8}
\]</span></p>
<p>This demonstrates how analytic functions can be decomposed into their magnitude and phase components in the complex plane.</p>
<!--
Cosine simularity: 0.9124673701607288
-->
</section>
<section id="integration-of-discontinuous-functions-in-complex-analysis" class="level2">
<h2 class="anchored" data-anchor-id="integration-of-discontinuous-functions-in-complex-analysis">Integration of Discontinuous Functions in Complex Analysis</h2>
<p>We can evaluate <span class="math inline">\(4 \sqrt{2} e^{i \pi/8}\)</span> and <span class="math inline">\(1 - i = \sqrt{2} e^{-i \pi/4}\)</span> by considering their arguments. The function can be evaluated either directly or by using the conjugated argument to obtain the conjugated images.</p>
<p>In the context of contour integration, if we integrate a function over a closed contour in the complex plane, the value of the integral is determined by all non-analytic features inside the contour. For poles, this is given by residues; for branch points, it involves the behavior around the discontinuity.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even for discontinuous functions, the integral can be numerically well-defined. For example, integrating <span class="math inline">\(\sqrt{x}\)</span> over a circle of radius 1 converges despite the discontinuity at <span class="math inline">\(x = 0\)</span>.</p>
</div>
</div>
<p>Consider the function defined on the unit circle:<br>
- Above <span class="math inline">\(\phi = 0\)</span>, the function is <span class="math inline">\(+i\)</span>.<br>
- Below <span class="math inline">\(\phi = 0\)</span>, it is <span class="math inline">\(-i\)</span>.<br>
This creates a jump discontinuity at <span class="math inline">\(\phi = 0\)</span> (or <span class="math inline">\(2\pi\)</span>).</p>
<p>To compute the integral, we parameterize <span class="math inline">\(x = e^{i \phi}\)</span>:</p>
<p><span class="math display">\[
\int_{0}^{2\pi} e^{i \phi} \cdot i \, d\phi \cdot \sqrt{e^{i \phi}}
\]</span></p>
<p>Simplifying, this becomes:</p>
<p><span class="math display">\[
\int_{0}^{2\pi} e^{i \phi (1 + \frac{1}{2})} \cdot i \, d\phi = \int_{0}^{2\pi} e^{i \frac{3}{2} \phi} \cdot i \, d\phi
\]</span></p>
<p>However, because the function is discontinuous, we cannot naively evaluate it at the endpoints. Instead, we shift the integration range to avoid the discontinuity:</p>
<p><span class="math display">\[
\int_{-\pi}^{\pi} e^{i \frac{3}{2} \phi} \cdot i \, d\phi
\]</span></p>
<p>This ensures the function is continuous within the new range, making the integral well-defined. The key takeaway is that even with discontinuities, careful treatment of the integration domain allows for convergent results.</p>
<p>The example illustrates how branch points and discontinuities can be handled in complex integration, similar to integrating around branch cuts.</p>
<!--
Cosine simularity: 0.9449375259218931
-->
</section>
<section id="analyticity-and-unitarity-in-scattering-amplitudes" class="level2">
<h2 class="anchored" data-anchor-id="analyticity-and-unitarity-in-scattering-amplitudes">Analyticity and Unitarity in Scattering Amplitudes</h2>
<p>The integration direction is equivalent to integrating the function in this direction. If we shrink the contour, it becomes an integral from zero to minus one of the function evaluated above. One probably finds the same answer, which in this case will be five.</p>
<p>This is a nice property of analytic functions, where Cauchy’s theorem plays a crucial role. It states that you can deform your contour of integration freely as long as you avoid non-analytic regions. You can compute the integral along a circular contour or shrink it into a different path. For this example, I encourage you to verify that these methods yield the same result. If they don’t, we can discuss it further—I believe it’s a straightforward calculation, but we’ll proceed for now.</p>
<p>What remains is to evaluate the imaginary part of the expression, which is simply <span class="math inline">\(\sqrt{x} \cdot i\)</span> (or without the <span class="math inline">\(i\)</span>), leading to a simple integration on the real axis.</p>
<p>The scattering amplitude is a remarkable function. Returning to our earlier discussion, we derived the optical theorem and examined the analytic structure of this function. The claim is that the amplitude is a “real magic” function—or at least part of it.</p>
<p>Let’s clarify the assumptions and physical principles here. The amplitude itself is not directly measurable in experiments; we only observe its square. Access to the amplitude is indirect, mediated by observables. However, scattering theory and probability conservation impose constraints on the amplitude, particularly on its imaginary part, and dictate where this imaginary part exists.</p>
<p>The analyticity of the amplitude is a postulate—a foundational principle of our framework. It’s stronger than an assumption; it’s the building block of our series. All theories we’ve discussed so far incorporate unitarity, which is tied to causality—a property linked to analyticity.</p>
<p>The amplitude being analytic is postulated in our theory, but it’s connected to causality: events outside each other’s light cones cannot influence one another. This relationship between causality and analyticity is discussed in various textbooks, but we take it as a given here.</p>
<p>Unitarity further refines this picture. The amplitude is real analytic below the threshold, meaning it has no imaginary part in this regime. The imaginary part arises only above the threshold, as it’s associated with particle production in intermediate states. Below threshold, the amplitude is purely real.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The optical theorem connects the imaginary part of the amplitude to the total cross-section, reinforcing the relationship between analyticity and unitarity.</p>
</div>
</div>
<p>This structure—analyticity, unitarity, and causality—forms the backbone of scattering theory, ensuring consistency with physical principles while enabling predictive power.</p>
<!--
Cosine simularity: 0.9521017548198791
-->
</section>
<section id="threshold-singularities-and-branch-points-in-scattering-amplitudes" class="level2">
<h2 class="anchored" data-anchor-id="threshold-singularities-and-branch-points-in-scattering-amplitudes">Threshold Singularities and Branch Points in Scattering Amplitudes</h2>
<p>Below the threshold, the amplitude has no imaginary part—it is purely real. Consider a diagram on the x-axis representing the complex plane of energy, where <span class="math inline">\(S = E^2\)</span> and <span class="math inline">\(E\)</span> is the center-of-mass energy. The amplitude <span class="math inline">\(A(S)\)</span> is an analytic function, but we typically deal with its values only above the threshold. However, the principles of our theory allow us to extend the domain of definition into the full complex plane using analyticity.</p>
<p>This means we can treat the amplitude as a complex function, probing it not just for real interaction energies (e.g., 5 GeV) but also for complex values. This extended function exhibits singularities, particularly branch points. The absence of an imaginary part below threshold and its sudden appearance above threshold indicates the emergence of these singularities.</p>
<p>For example, the two-particle threshold introduces a square-root singularity, as seen in the prefactor of the imaginary part of the amplitude:</p>
<p><span class="math display">\[
\text{Im} \, A(s) = \frac{1}{2} \cdot \frac{1}{8\pi} \cdot \frac{2p}{\sqrt{s}} |a(s)|^2
\]</span></p>
<p>Here, <span class="math inline">\(p\)</span> is the breakup momentum, given by:</p>
<p><span class="math display">\[
p = \frac{\lambda^{1/2}}{2\sqrt{s}}, \quad \lambda^{1/2}(s, m_1^2, m_2^2) = \sqrt{[s - (m_1 + m_2)^2][s - (m_1 - m_2)^2]}
\]</span></p>
<p>The breakup momentum <span class="math inline">\(p\)</span> vanishes at the threshold, where the system has minimal energy—just the sum of the particle masses. At this point, the particles have no residual momentum, and the singularity arises from the vanishing of <span class="math inline">\(p\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The phase space factor <span class="math inline">\(\frac{2p}{\sqrt{s}}\)</span> in the imaginary part of the amplitude is directly tied to the two-body phase space and vanishes at threshold, reflecting the kinematic constraints of particle production.</p>
</div>
</div>
<p>This structure is generic: every threshold introduces singularities, and their form depends on the number of particles involved. For a detailed derivation, refer to Gribov’s book, but the square-root singularity for the two-particle case is straightforward to derive from the properties of the imaginary part and phase space.</p>
<!--
Cosine simularity: 0.9657801956878016
-->
</section>
<section id="threshold-singularities-and-the-schwarz-reflection-principle" class="level2">
<h2 class="anchored" data-anchor-id="threshold-singularities-and-the-schwarz-reflection-principle">Threshold Singularities and the Schwarz Reflection Principle</h2>
<p>For mathematically, you see that if you compute the two-body breakup momentum, you find that it is equal to the Cullen function:</p>
<p><span class="math display">\[
x^2 + y^2 + z^2 - 2xy - 2yz - 2zx
\]</span></p>
<p>This can be arranged as the product of two terms:</p>
<p><span class="math display">\[
(x - y + z) \cdot (x - y - z)
\]</span></p>
<p>Here, <span class="math inline">\(x, y, z\)</span> represent the masses of the two particles and their differences. The first term gives a singularity at the threshold, while the second gives a singularity at the pseudothreshold.</p>
<p>The relation we wrote is valid only above the threshold, where the imaginary part is non-zero and appears only once you cross the threshold. This imaginary part exhibits a square-root behavior, indicating that the function itself has a square-root singularity.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The square-root singularity above the threshold suggests a branch point in the amplitude, connecting the function’s behavior in the upper and lower half-planes.</p>
</div>
</div>
<p>This connects to the Schwarz reflection principle. Since our function was real and analytic on a segment of the real axis, the Schwarz reflection principle applies. It relates the amplitude in the upper half-plane to the amplitude in the lower half-plane. If the function <span class="math inline">\(F(z)\)</span> is analytic in the upper half-plane and real on the real axis, then:</p>
<p><span class="math display">\[
F(z^*) = F^*(z)
\]</span></p>
<p>This allows us to analytically continue the amplitude into the full complex plane, revealing the structure of singularities and their implications for scattering amplitudes.</p>
<!--
Cosine simularity: 0.8956985218406526
-->
</section>
<section id="analytic-structure-and-branch-points-in-complex-functions" class="level2">
<h2 class="anchored" data-anchor-id="analytic-structure-and-branch-points-in-complex-functions">Analytic Structure and Branch Points in Complex Functions</h2>
<p>The function <span class="math inline">\(F(x + i\epsilon)\)</span> tells us that the imaginary part flips when crossing the real axis from above to below. This is a relation where <span class="math inline">\(\epsilon\)</span> is infinitesimal.</p>
<p>The term “infinitesimal” means very, very small. In this context, <span class="math inline">\(i\epsilon\)</span> is a small imaginary displacement indicating whether you are evaluating the function just above or just below the real axis.</p>
<p>This behavior arises due to phase space considerations. If there were no phase space configuration summations, the imaginary part could be directly related to the amplitude itself, and there might not even be branch points. However, summing over phase space configurations introduces a square-root branch point.</p>
<p>This branch point indicates that the amplitude has a singularity starting at the threshold and extending in the positive direction.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The amplitude’s branch point structure is tied to the analytic continuation of the function across the real axis, where the function’s value changes depending on the direction of approach.</p>
</div>
</div>
<p>To illustrate this, consider a simple real analytic function with a branch cut, such as the square root function. The square root of <span class="math inline">\(x\)</span> has a branch cut on the left side of the complex plane.</p>
<p>To determine where the branch cut lies, evaluate the function just above and below the real axis:</p>
<ul>
<li>For <span class="math inline">\(x = -1 + i\epsilon\)</span>, <span class="math inline">\(\sqrt{-1 + i\epsilon} = i\)</span><br>
</li>
<li>For <span class="math inline">\(x = -1 - i\epsilon\)</span>, <span class="math inline">\(\sqrt{-1 - i\epsilon} = -i\)</span></li>
</ul>
<p>This shows that the function changes sign when crossing the branch cut, confirming its non-analytic nature.</p>
<p>A branch point splits the complex plane into distinct Riemann sheets, where the function takes different values on each sheet. The branch cut is the curve connecting the branch point to infinity, separating these sheets.</p>
<p>The square-root singularity is a common feature in scattering amplitudes, particularly near kinematic thresholds. This structure is mathematically unavoidable due to the phase space constraints and leads to the analytic properties observed in physical amplitudes.</p>
<p>The Schwarz reflection principle further connects the behavior of the amplitude in the upper and lower half-planes. If <span class="math inline">\(F(z)\)</span> is analytic in the upper half-plane and real on the real axis, then:</p>
<p><span class="math display">\[
F(z^*) = F^*(z)
\]</span></p>
<p>This allows for the analytic continuation of the amplitude into the full complex plane, revealing the underlying singularity structure.</p>
<!--
Cosine simularity: 0.9321677706056716
-->
</section>
<section id="analytic-continuation-and-branch-cuts-in-complex-functions" class="level2">
<h2 class="anchored" data-anchor-id="analytic-continuation-and-branch-cuts-in-complex-functions">Analytic Continuation and Branch Cuts in Complex Functions</h2>
<p>The functions in question exhibit analyticity everywhere except at certain points, and you must work to verify this analyticity. Essentially, you need to analytically continue these functions. If you observe the pattern, you can always make the function analytic, but it requires extending the domain of analyticity.</p>
<p>Returning to the example, consider the function <span class="math inline">\(-X\)</span>. Its analytic structure can be evaluated in the complex plane, revealing full analyticity except for a branch cut extending to the right. Evaluating this function at <span class="math inline">\(-1\)</span> gives:</p>
<p><span class="math display">\[
F(-1) = 1 - (-1) = 2
\]</span></p>
<p>This is an example of a real analytic function. Another example is the amplitude:</p>
<p><span class="math display">\[
A(s) = \sqrt{-s + m_1 m_2}
\]</span></p>
<p>This function has similar properties.</p>
<p>In the <span class="math inline">\(x\)</span>-plane, the first function has a branch cut on the right, while the second function has a shifted cut. When these cuts overlap, there is no discontinuity, and the function remains analytic in that region. The correct structure consists of cuts connecting two points, which can be subtle to identify at first glance.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The absence of a jump in the function where cuts overlap indicates analyticity in that region, despite the presence of branch cuts elsewhere.</p>
</div>
</div>
<p>The square-root function serves as a simple illustration of branch cuts. For example:</p>
<ul>
<li><span class="math inline">\(\sqrt{-1 + i\epsilon} = i\)</span><br>
</li>
<li><span class="math inline">\(\sqrt{-1 - i\epsilon} = -i\)</span></li>
</ul>
<p>This sign change across the branch cut confirms the non-analytic behavior.</p>
<p>The Schwarz reflection principle connects the function’s behavior in the upper and lower half-planes:</p>
<p><span class="math display">\[
F(z^*) = F^*(z)
\]</span></p>
<p>This allows for analytic continuation and reveals the underlying singularity structure. The branch points and cuts are intrinsic to the function’s behavior in the complex plane.</p>
<!--
Cosine simularity: 0.9784571421257063
-->
</section>
<section id="branch-points-and-cuts-in-complex-square-roots" class="level2">
<h2 class="anchored" data-anchor-id="branch-points-and-cuts-in-complex-square-roots">Branch Points and Cuts in Complex Square Roots</h2>
<p>The cuts connect two points, which is a tricky concept. The first time I saw this in a mathematical context, I was shocked because the branch points are the same — there are two points <span class="math inline">\(X\)</span> and <span class="math inline">\(X\)</span> where the function is non-analytic.</p>
<p>The location of the cut is determined by where the imaginary part of the expression under the square root has an argument of <span class="math inline">\(\pi\)</span> or <span class="math inline">\(-\pi\)</span>. For the regular square root function, the cut appears where the argument is either <span class="math inline">\(1\)</span> or <span class="math inline">\(-1\)</span>.</p>
<p>To understand where Mathematica, C, or Python libraries would draw a cut, you need to analyze where the expression under the square root has an argument touching <span class="math inline">\(\pi\)</span> or <span class="math inline">\(-\pi\)</span>. The cut lies between the points and also extends along a line to infinity.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The first cut goes to infinity, and the second cut also goes to infinity, but this behavior differs from other cases.</p>
</div>
</div>
<p>If you split the product into two square roots, the argument changes, and you remove these two cuts. This is not meant to confuse but to warn that one must be careful with how expressions are written. The exact way you split the square root affects the function’s behavior — they may appear the same on the real axis but differ in the complex plane.</p>
<!--
Cosine simularity: 0.9669317522559626
-->
</section>
<section id="resonances-and-internet-router-analogy-in-complex-plane" class="level2">
<h2 class="anchored" data-anchor-id="resonances-and-internet-router-analogy-in-complex-plane">Resonances and Internet Router Analogy in Complex Plane</h2>
<p>The amplitude <span class="math inline">\(A\)</span> is given by:</p>
<p><span class="math display">\[
A = \frac{g^2}{m_R^2 - s}, \quad m_R^2 = \left( m_R - i \frac{\Gamma}{2} \right)^2, \quad g^2 = -\text{Res}_{m_R^2}A
\]</span></p>
<p>On the complex plane, the functions are different. To prove they are not equal, we can evaluate the function here minus one. The analytic structure of this function consists of one cut and then a second cut, with two branch points connected by the cut. To transform from this configuration to another, we can take this cut, rotate it over here, take the other cut, rotate it over there, and cancel the two cuts. This shows that the function in the original configuration has a different value minus one.</p>
<p>Evaluating the top expression gives:</p>
<p><span class="math display">\[
\sqrt{-2 + 2 - 1 - 2 + 2}
\]</span></p>
<p>while evaluating the second expression gives:</p>
<p><span class="math display">\[
\sqrt{2i}
\]</span></p>
<p>The product of these results is <span class="math inline">\(-\sqrt{2}\)</span>. Resonances are poles of the scattering amplitude. When you hear about resonances, think of the intensity flow. The function in the complex plane is like the structure of a house, and the routers in the house are the resonances. The farther you are from the router, the weaker the signal you receive. If you sit at a point with good Internet, you are likely close to a router.</p>
<p>This is analogous to our position in the house where people experience different Internet strengths. The routers represent the resonances. Here, the Y-axis represents the complex <span class="math inline">\(S\)</span> plane, with real <span class="math inline">\(S\)</span> on the axis and minus imaginary <span class="math inline">\(S\)</span> indicated here. This is the same as the complex frame. A square represents the strength of your Internet when you sit on the couch. The middle of the square is the closest distance to the router (resonance), so the signal strength is highest. As you move away, the Internet weakens.</p>
<p>Now, let’s make the house more complex by adding several floors. The cuts represent the map of the room. The couch where people sit is on the real axis, but the house has multiple floors with different electronics. If there is a router in another room, you can still experience its influence from your position.</p>
<p>Sheet one represents floor one, and sheet two represents floor two. The gate is like stairs connecting the floors. If a router is placed here, the signal strength is strong here and here, but weakens around the corner. The distance increases, and the signal must travel around the wall. The gate to the other floor allows access only from one side.</p>
<p>The picture of floors and routers is helpful but can be overwhelming. The routers are the resonances, and you can see them on each floor if they are above the threshold. When you hear about the complex plane and poles, think of the intensity flow in the house.</p>
<!--
Cosine simularity: 0.9379185276533604
-->
</section>
<section id="complex-plane-and-branch-cuts-in-router-analogy" class="level2">
<h2 class="anchored" data-anchor-id="complex-plane-and-branch-cuts-in-router-analogy">Complex Plane and Branch Cuts in Router Analogy</h2>
<p>The pulse can be visualized as the intensity floor in the complex domain. There are gates connecting different floors, but these do not change the level—they simply link one floor to another. On this multi-level surface, routers are placed, influencing the intensity observed on the relaxers.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The difference between a larger room and multiple floors is negligible. Both are infinitely large, but the floors are smoothly connected, requiring multiple maps or sheets for representation—similar to shopping mall floor plans.</p>
</div>
</div>
<p>For the square root function <span class="math inline">\(\sqrt{x}\)</span>, the branch cut is conventionally placed to the right, but practically, nothing prevents placing it to the left. Consider evaluating the function at <span class="math inline">\(-1\)</span>:</p>
<p><span class="math display">\[
\sqrt{-1} = i
\]</span></p>
<p>For <span class="math inline">\(-1 + \epsilon\)</span> (where <span class="math inline">\(\epsilon\)</span> is infinitesimal), the result remains <span class="math inline">\(i\)</span>. Rotating the branch cut simply reconfigures the “rooms” (sheets) without altering the function’s behavior. The cut is merely a way to separate floors, not a physical barrier—there are no walls blocking signal strength.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For practical convenience, it is natural to place the branch cut in the most accessible location, such as the negative real axis.</p>
</div>
</div>
<p>The analytic structure of the function involves branch points connected by cuts. Transforming between configurations involves rotating cuts and canceling overlapping segments. For example, evaluating:</p>
<p><span class="math display">\[
\sqrt{-2 + 2 - 1 - 2 + 2}
\]</span></p>
<p>yields a different result than:</p>
<p><span class="math display">\[
\sqrt{2i}
\]</span></p>
<p>The product of these results is <span class="math inline">\(-\sqrt{2}\)</span>.</p>
<p>In the router analogy, resonances are like routers in a house. The signal strength (intensity) diminishes with distance from the router. Sitting close to a router (resonance) ensures strong Internet (amplitude), while moving away weakens it. The complex plane is structured like a multi-floor house, with cuts representing the map of connected rooms.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The real axis is where observers (people on the couch) reside, but routers on other floors (sheets) still influence the signal. Gates (branch cuts) act as staircases connecting floors, allowing access from specific directions.</p>
</div>
</div>
<p>The routers (resonances) are visible on each floor if they lie above the threshold. The farther the router, the weaker its influence, analogous to poles in the complex plane. The picture of floors and routers helps visualize the analytic structure, though it can become overwhelming.</p>
<!--
Cosine simularity: 0.9136396991673359
-->
</section>
<section id="poles-and-resonances-in-the-complex-plane" class="level2">
<h2 class="anchored" data-anchor-id="poles-and-resonances-in-the-complex-plane">Poles and Resonances in the Complex Plane</h2>
<p>The branch cut can be placed in a convenient location, such as to the right, but it can also be rotated to the left. This exposes a larger range of the complex plane for analysis, even though the function may no longer be real.</p>
<p>When measuring an amplitude above threshold (at <span class="math inline">\((M_1 + M_2)^2\)</span>), the observed value is influenced by nearby structures in the complex plane. If a resonance appears in the data, it corresponds to a pole beneath it in the complex plane.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Resonances are always associated with poles, and this is how we define particles — as poles in the amplitude.</p>
</div>
</div>
<p>A single-pole amplitude has the form:</p>
<p><span class="math display">\[
A(s) = \frac{1}{s - s_0}
\]</span></p>
<p>where <span class="math inline">\(s_0\)</span> (or <span class="math inline">\(\bar{m}^2\)</span>) is the pole location where the denominator vanishes. This is a complex number, with its real and imaginary parts defining the mass and width of the resonance:</p>
<ul>
<li><strong>Mass of the pole</strong>: Real part of <span class="math inline">\(\sqrt{s_0}\)</span><br>
</li>
<li><strong>Width of the pole</strong>: Twice the imaginary part of <span class="math inline">\(\sqrt{s_0}\)</span> (i.e., <span class="math inline">\(\Gamma = -2 \ \text{Im}(\sqrt{s_0})\)</span>)</li>
</ul>
<p>These quantities relate to the experimentally observed mass and width of the resonance.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The pole is literally a zero of the denominator in the amplitude, and its position in the complex plane determines the physical properties of the resonance.</p>
</div>
</div>
<p>The influence of a pole diminishes with distance, analogous to signal strength weakening as you move away from a router. The complex plane acts like a multi-level structure, where resonances (poles) on different “floors” (sheets) still affect observations made on the real axis.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>For practical analysis, it is often most convenient to place branch cuts where they provide the clearest access to the poles of interest.</p>
</div>
</div>
<p>The observed amplitude at a given point on the real axis is shaped by nearby poles, and their effects are directly visible in the data. This framework connects the mathematical structure of the amplitude to measurable physical quantities.</p>
<!--
Cosine simularity: 0.940092977628945
-->
</section>
<section id="analytic-structure-and-pole-characterization-in-resonances" class="level2">
<h2 class="anchored" data-anchor-id="analytic-structure-and-pole-characterization-in-resonances">Analytic Structure and Pole Characterization in Resonances</h2>
<p>Pole locations are related to the observed mass and width, which are experimentally measurable. When observing a signal, it has a peak location and a full width at half maximum (FWHM). For narrow resonances, the width <span class="math inline">\(\Gamma\)</span> is approximately equal to the FWHM, and the mass <span class="math inline">\(M\)</span> is approximately equal to the peak location. However, this is not the case for broad resonances.</p>
<p>The analytic structure of this function is simply a pole — there are no branch points or other complexities. A slightly more complex example involves the relativistic Wigner case, which includes a pole in the <span class="math inline">\(K\)</span>-matrix and a square root branch point from phase space. The <span class="math inline">\(K\)</span>-matrix is a method to incorporate poles while maintaining the correct analytic structure, and it works for multiple loops.</p>
<p>The ultimate goal in data analysis is to characterize resonances by their pole mass and width. This is achieved using parameterizations like the <span class="math inline">\(K\)</span>-matrix or other frameworks.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For narrow resonances, the pole mass and width directly correspond to the observed peak and FWHM, but this approximation breaks down for broader resonances.</p>
</div>
</div>
<p>The <span class="math inline">\(K\)</span>-matrix ensures the proper analytic structure, including poles and branch cuts, while remaining applicable to multi-loop processes.</p>
<!--
Cosine simularity: 0.9481211051651367
-->
</section>
<section id="branch-points-and-threshold-singularities-in-amplitude-analysis" class="level2">
<h2 class="anchored" data-anchor-id="branch-points-and-threshold-singularities-in-amplitude-analysis">Branch Points and Threshold Singularities in Amplitude Analysis</h2>
<p>We parameterize the amplitude using the <span class="math inline">\(K\)</span>-matrix or, in simpler cases, the Breit-Wigner formula, which is a limiting case of the <span class="math inline">\(K\)</span>-matrix unless constraints are applied. The amplitude’s expression can be complex, with many terms, but it remains an analytic function. By fitting data, we determine the parameters and then explore the analytic structure.</p>
<p>For branch points, you must decide their placement (e.g., to the left or right in the complex plane). Importantly, all features in the amplitude—peaks, spikes, or cusps—originate from singularities in the complex plane. A peak typically indicates a pole, while a cusp (seen in <span class="math inline">\(|A|^2\)</span> vs.&nbsp;<span class="math inline">\(S\)</span> plots) corresponds to another type of branch point.</p>
<p>Every threshold introduces a singularity. For two-particle systems, this is a branch point. For example, <span class="math inline">\(\pi\pi\)</span> or <span class="math inline">\(KK\)</span> thresholds introduce branch points at specific energies (e.g., <span class="math inline">\(KK\)</span> at 1 GeV). These manifest as spikes in the amplitude, signaling the presence of a branch point in the complex plane.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Each branch point requires attaching a “tail” (branch cut) in the complex plane, which influences the amplitude’s behavior.</p>
</div>
</div>
<p>The <span class="math inline">\(K\)</span>-matrix method ensures the correct analytic structure, incorporating both poles and branch points while remaining applicable to multi-loop processes.</p>
<!--
Cosine simularity: 0.9598991744416047
-->
</section>
<section id="threshold-enhancements-and-pole-structures-in-amplitude-analysis" class="level2">
<h2 class="anchored" data-anchor-id="threshold-enhancements-and-pole-structures-in-amplitude-analysis">Threshold Enhancements and Pole Structures in Amplitude Analysis</h2>
<p>Every branch point requires attaching a “tail” (branch cut) in the complex plane, and the placement of the cut is arbitrary — it’s up to you how to draw it. However, this introduces additional Riemann surfaces.</p>
<p>For a triangle diagram, if the amplitude has square root singularities at threshold, these thresholds only open new surfaces in the complex plane. The real singularities — or the strong features that produce intensity peaks — are poles.</p>
<p>When the amplitude squared exhibits threshold behavior but rises sharply and then falls, this suggests the presence of nearby poles. If the poles lie below threshold, the amplitude peaks at that location. In such cases, this typically indicates a bound state — a pole on the real axis. However, a pole on the real axis does not produce a resonance-like peak.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Threshold enhancements are often signs of poles below threshold, which correspond to bound states.</p>
</div>
</div>
<p>An analogous example is the signal strength from a router: the intensity is strongest near the router and diminishes with distance. This is how threshold enhancements can be understood. There is also the phenomenon of poles at the same locations but beneath the threshold.</p>
<!--
Cosine simularity: 0.9755648752216739
-->
</section>
<section id="virtual-states-and-molecular-nature-in-particle-physics" class="level2">
<h2 class="anchored" data-anchor-id="virtual-states-and-molecular-nature-in-particle-physics">Virtual States and Molecular Nature in Particle Physics</h2>
<p>There is another phenomenon of the poles at the same locations, but underneath another sheet which is called a virtual state. Both of them are not that different from each other. This state can live forever — it is a real state that can travel, a particle that does not decay. Another case is the one that does not travel and does not decay. This distinction is one of the objectives and discussion points in the field.</p>
<p>When you observe a new structure, the key questions are:<br>
- What kind of structure is it?<br>
- Is it related to a threshold?<br>
- Is it a pole sitting below a certain threshold?<br>
- Or is it a resonance in the complex plane unrelated to a threshold?</p>
<p>Relation to a threshold indicates molecular nature. Every threshold involves two masses summed together, implying a continuum — one particle interacting with another. If a pole is related to a threshold, part of the wave function for this state is likely of molecular type.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Identifying thresholds and the complex structure of resonance poles is crucial for determining whether a state has molecular characteristics.</p>
</div>
</div>
<!--
Cosine simularity: 0.924689262282351
-->
</section>
<section id="false-thresholds-and-imaginary-parts-in-amplitude-analysis" class="level2">
<h2 class="anchored" data-anchor-id="false-thresholds-and-imaginary-parts-in-amplitude-analysis">False Thresholds and Imaginary Parts in Amplitude Analysis</h2>
<p>The expression <span class="math inline">\((S - M_1 + M_2)^2\)</span> corresponds to the “soil threshold,” but it is actually a <strong>false threshold</strong>. It appears artificially in our calculations due to the breakup momentum. However, the amplitude itself is not supposed to have a singularity at this point.</p>
<p>This indicates that you should not take this expression literally and continue it beyond the threshold. Instead, the correct approach involves using the phase space factor <span class="math inline">\(\frac{2p}{\sqrt{S}}\)</span>, which is the <strong>imaginary part</strong> of the amplitude.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The false threshold arises when only the imaginary part of the amplitude is considered. If you take the full bubble diagram, the false threshold disappears.</p>
</div>
</div>
<p>The imaginary part can be derived from unitarity: when you cut the diagram, it corresponds to the product of matrix elements (both equal to 1) and the two-body phase space. This is why the false threshold appears — it is an artifact of isolating the imaginary part.</p>
<p>Originally, we planned to compute the bubble diagram explicitly in this lecture, as it is closely related to unitarity. However, the discussion on false thresholds and their origin provides key insights into why such singularities are not physical.</p>
<!--
Cosine simularity: 0.8862112540954399
-->
</section>
<section id="climbing-kilimanjaro-and-pumping-techniques" class="level2">
<h2 class="anchored" data-anchor-id="climbing-kilimanjaro-and-pumping-techniques">Climbing Kilimanjaro and Pumping Techniques</h2>
<p>The period is when you take the imaginary part. The full amplitude does not have it.</p>
<p>The easiest level for climbing Kilimanjaro is level one. We start with the green and orange, then proceed to gray, yellow, white, brown, and blue.</p>
<p>For pumping, use three fingers at once without hardware. Start with the spot and orange, then release and hang on these two.</p>
<p>The green and the last one is orange chicken.</p>
<!--
Cosine simularity: 0.9758889978114851
-->
</section>
<section id="market-writing-and-infinite-concepts" class="level2">
<h2 class="anchored" data-anchor-id="market-writing-and-infinite-concepts">Market Writing and Infinite Concepts</h2>
<p>All right. Now green and the last one is orange chicken.<br>
That’s a large step. It’s a matter of writing market here.<br>
Did you find infinite? But not the mother. Say the M1 and M2.<br>
But it’s still well done.</p>
<!--
Cosine simularity: 0.9960124838713215
-->
</section>
<section id="pinchus-demonstration-and-clarification" class="level2">
<h2 class="anchored" data-anchor-id="pinchus-demonstration-and-clarification">Pinchus Demonstration and Clarification</h2>
<p>M1 and M2. Right. Okay. But it’s still well done. Thanks a lot. You’re about less. Nice. I’m not yet at pinches. Pinchus is like this. This is something different.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>